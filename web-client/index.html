<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Главная</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <div class="container">
        <h1>Трекер часов</h1>
        <p class="subtitle">Геннадий придумай зайповый лозунг</p>
    </div>
</header>

<div class="container">
    <nav>
        <ul>
            <li><a href="#" onclick="showSection('dashboard')" class="active">Главная</a></li>
            <li><a href="#" onclick="showSection('tasks')">Задачи</a></li>
            <li><a href="#" onclick="showSection('team')">Команда</a></li>
        </ul>
    </nav>

    <!-- ГЛАВНАЯ -->
    <section id="dashboard" class="content-section">
        <div class="dashboard-grid">

            <!-- Команда -->
            <div class="card">
                <div class="flex justify-between align-center mb-1">
                    <h2>Ваша команда</h2>
                    <button onclick="openModal('createTeamModal')" id="createTeamBtn">Создать команду</button>
                </div>

                <div id="teamInfo">
                    <p style="color:#777; text-align:center;">Вы не в команде</p>
                </div>

                <div id="inviteLinkSection" style="margin-top:1rem; display:none;">
                    <label>Ссылка-приглашение:</label>
                    <div class="input-group">
                        <input type="text" id="inviteLink" readonly>
                        <button onclick="copyInviteLink()">Копировать</button>
                    </div>
                </div>
            </div>

            <!-- Задачи + Гант -->
            <div>
                <div class="card mb-2">
                    <div class="flex justify-between align-center mb-1">
                        <h2>Задачи</h2>
                        <button onclick="openModal('createTaskModal')">+ Задача</button>
                    </div>
                    <div id="tasksList"></div>
                </div>

                <div class="card">
                    <h2>Обратная диаграмма Ганта</h2>
                    <div id="ganttChart"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Все задачи -->
    <section id="tasks" class="content-section" style="display:none;">
        <div class="card">
            <h2>Все задачи</h2>
            <table id="allTasksTable">
                <thead>
                <tr>
                    <th>Задача</th>
                    <th>Роль</th>
                    <th>Дедлайн</th>
                    <th>Статус</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </section>

    <!-- Команда -->
    <section id="team" class="content-section" style="display:none;">
        <div class="card">
            <h2>Участники команды</h2>
            <div id="teamMembersList">
                <p style="color:#777;">Нет данных</p>
            </div>
        </div>
    </section>
</div>


<!-- Создание команды -->
<div id="createTeamModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('createTeamModal')">&times;</span>
        <h2>Создать команду</h2>
        <form id="createTeamForm">
            <label>Название команды *</label>
            <input type="text" id="teamName" required placeholder="Введите название">

            <label>Предмет *</label>
            <input type="text" id="teamSubjectInput" required placeholder="Введите предмет">

            <div class="mt-1">
                <button type="button" onclick="createTeam()">Создать</button>
            </div>
        </form>
    </div>
</div>

<!-- Создание задачи -->
<div id="createTaskModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('createTaskModal')">&times;</span>
        <h2>Новая задача</h2>
        <form id="createTaskForm">
            <label>Название *</label>
            <input type="text" id="taskName" required>

            <label>Роль *</label>
            <input type="text" id="taskRoleInput" required placeholder="Введите роль">

            <label>Дедлайн *</label>
            <input type="datetime-local" id="taskDeadline" required>

            <label>Зависит?</label>
            <select id="taskDependsOn">
                <option value="">Нет зависимости</option>
            </select>

            <div class="mt-1">
                <button type="button" onclick="createTask()">Создать</button>
            </div>
        </form>
    </div>
</div>

<!-- Редактирование задачи -->
<div id="editTaskModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('editTaskModal')">&times;</span>
        <h2>Редактировать задачу</h2>
        <form id="editTaskForm">
            <input type="hidden" id="editTaskId">
            <label>Название *</label>
            <input type="text" id="editTaskName" required>

            <!-- Свободный ввод роли -->
            <label>Роль *</label>
            <input type="text" id="editTaskRoleInput" required placeholder="Введите роль">

            <label>Дедлайн *</label>
            <input type="datetime-local" id="editTaskDeadline" required>
            <label>Зависит от</label>
            <select id="editTaskDependsOn">
                <option value="">Нет зависимости</option>
            </select>
            <div class="mt-1 flex gap-1">
                <button type="button" onclick="saveTaskEdit()">Сохранить</button>
                <button type="button" onclick="deleteTaskConfirm()" style="background:#e74c3c;">Удалить</button>
                <button type="button" onclick="closeModal('editTaskModal')" class="secondary">Отмена</button>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js"></script>
</body>
</html>