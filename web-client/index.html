<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Трекер часов</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <div class="container">
        <h1>Трекер часов</h1>
        <p class="subtitle">геннадий все таки придется нам придумать</p>
    </div>
</header>

<div class="container">
    <nav>
        <ul>
            <li><a href="#" onclick="showSection('dashboard')" class="active">Главная</a></li>
            <li><a href="#" onclick="showSection('tasks')">Задачи</a></li>
            <li><a href="#" onclick="showSection('team')">Команда</a></li>
        </ul>
    </nav>

    <!-- Главная -->
    <section id="dashboard" class="content-section">
        <div class="dashboard-grid">
            <!-- Команда -->
            <div class="card">
                <div class="flex justify-between align-center mb-1">
                    <h2>Ваша команда</h2>
                    <button onclick="openModal('createTeamModal')" id="createTeamBtn">Создать команду</button>
                </div>

                <div id="teamInfo">
                    <p style="color:#777; text-align:center; margin-bottom:1rem;">Вы не в команде</p>

                    <!-- Ссылка-приглашение -->
                    <div id="joinByLinkSection" style="margin-top:1rem; padding:1rem; background:#f8f9fa; border-radius:12px; border:2px dashed #3498db;">
                        <label style="display:block; margin-bottom:0.5rem; font-weight:600; color:#2c3e50;">
                            Есть ссылка-приглашение?
                        </label>
                        <div class="input-group">
                            <input type="text" id="manualInviteInput" placeholder="Вставьте ссылку сюда..." style="flex:1;">
                            <button onclick="joinByManualLink()">Присоединиться</button>
                        </div>
                        <small style="color:#7f8c8d; display:block; margin-top:0.5rem;">
                            Например: https://site.com/?invite=1731845678901
                        </small>
                    </div>
                </div>

                <div id="inviteLinkSection" style="margin-top:1rem; display:none;">
                    <label>Ссылка-приглашение:</label>
                    <div class="input-group">
                        <input type="text" id="inviteLink" readonly>
                        <button onclick="copyInviteLink()">Копировать</button>
                    </div>
                </div>
            </div>

            <!-- Задачи + Гантт -->
            <div>
                <div class="card mb-2">
                    <div class="flex justify-between align-center mb-1">
                        <h2>Задачи</h2>
                        <button onclick="openModal('createTaskModal')">+ Задача</button>
                    </div>
                    <div id="tasksList"></div>
                </div>

                <div class="card">
                    <h2>Обратная диаграмма Ганта</h2>
                    <div id="ganttChart"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Все задачи -->
    <section id="tasks" class="content-section" style="display:none;">
        <div class="card">
            <h2>Все задачи</h2>
            <table id="allTasksTable">
                <thead>
                <tr>
                    <th>Задача</th>
                    <th>Роль</th>
                    <th>Ответственный</th>
                    <th>Дедлайн</th>
                    <th>Статус</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </section>

    <!-- Команда -->
    <section id="team" class="content-section" style="display:none;">
        <div class="card">
            <h2>Участники команды</h2>
            <div id="teamMembersList"><p style="color:#777;">Нет данных</p></div>
        </div>
    </section>
</div>

<!-- Модальные окна -->
<div id="createTeamModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('createTeamModal')">&times;</span>
        <h2>Создать команду</h2>
        <input type="text" id="teamName" placeholder="Название команды" required>
        <input type="text" id="teamSubjectInput" placeholder="Предмет" required>
        <div class="mt-1"><button onclick="createTeam()">Создать</button></div>
    </div>
</div>

<div id="createTaskModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('createTaskModal')">&times;</span>
        <h2>Новая задача</h2>
        <input type="text" id="taskName" placeholder="Название задачи" required>
        <input type="text" id="taskRoleInput" placeholder="Роль" required>
        <input type="text" id="taskAssignee" placeholder="Ответственный" value="">
        <input type="datetime-local" id="taskDeadline" required>
        <label>Зависит от:</label>
        <select id="taskDependsOn"><option value="">Нет зависимости</option></select>
        <div class="mt-1"><button onclick="createTask()">Создать</button></div>
    </div>
</div>

<div id="editTaskModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('editTaskModal')">&times;</span>
        <h2>Редактировать задачу</h2>
        <input type="hidden" id="editTaskId">
        <input type="text" id="editTaskName" required>
        <input type="text" id="editTaskRoleInput" required>
        <input type="text" id="editTaskAssignee">
        <input type="datetime-local" id="editTaskDeadline" required>
        <label>Зависит от:</label>
        <select id="editTaskDependsOn"><option value="">Нет зависимости</option></select>
        <div class="mt-1 flex gap-1">
            <button onclick="saveTaskEdit()">Сохранить</button>
            <button onclick="deleteTaskConfirm()" style="background:#e74c3c;">Удалить</button>
            <button onclick="closeModal('editTaskModal')" class="secondary">Отмена</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>